
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Building ALICE software Â· ALICE Analysis Tutorial</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-panels/panels.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-block-align/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-page-toc/page-toc.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../css/website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="prereq-macos.html" />
    
    
    <link rel="prev" href="../analysis/ROOT5-to-6.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../analysis/">
            
                <a href="../analysis/">
            
                    
                    Analysis Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../analysis/setup.html">
            
                <a href="../analysis/setup.html">
            
                    
                    Step 1 - Setup the tutorial
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../analysis/running.html">
            
                <a href="../analysis/running.html">
            
                    
                    Step 2 - Running the task
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../analysis/modify.html">
            
                <a href="../analysis/modify.html">
            
                    
                    Step 3 - Modify the task
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../analysis/track.html">
            
                <a href="../analysis/track.html">
            
                    
                    Step 4 -The track loop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../analysis/pid.html">
            
                <a href="../analysis/pid.html">
            
                    
                    Step 5 -Particle identification
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../analysis/grid.html">
            
                <a href="../analysis/grid.html">
            
                    
                    Step 6 -Run your code on GRID
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../analysis/bonus.html">
            
                <a href="../analysis/bonus.html">
            
                    
                    Bonus content
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="../analysis/hints.html">
            
                <a href="../analysis/hints.html">
            
                    
                    Some hints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="../analysis/ROOT5-to-6.html">
            
                <a href="../analysis/ROOT5-to-6.html">
            
                    
                    Transition from ROOT5 to ROOT6
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.3" data-path="./">
            
                <a href="./">
            
                    
                    Building ALICE software
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="prereq-macos.html">
            
                <a href="prereq-macos.html">
            
                    
                    aliBuild prerequisites for macOS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="prereq-ubuntu.html">
            
                <a href="prereq-ubuntu.html">
            
                    
                    aliBuild prerequisites for Ubuntu
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="prereq-centos7.html">
            
                <a href="prereq-centos7.html">
            
                    
                    aliBuild prerequisites for CentOS 7
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="prereq-fedora.html">
            
                <a href="prereq-fedora.html">
            
                    
                    aliBuild prerequisites for Fedora
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Building ALICE software</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="how-to-build-alice-software">How to build ALICE software</h1>
<p>The ALICE experiment currently has two frameworks:</p>
<ul>
<li><a href="https://github.com/alisw/AliRoot" target="_blank">AliRoot</a>/<a href="https://github.com/alisw/AliPhysics" target="_blank">AliPhysics</a> for
LHC Run 1 and Run 2</li>
<li><a href="https://github.com/AliceO2Group/AliceO2" target="_blank">O2</a>, currently under development, for Run 3 software</li>
</ul>
<p>Building software has become an increasingly complicated operation, as our software has many
dependencies and we expect it to work both on your laptop and on the Grid. In addition, we support
many Linux distributions and recent macOS versions.</p>
<p><div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(4002729107);" id="please-follow-the-instructions-closely"><i class="fa fa-info-circle"></i> Please follow the instructions closely!<span id="heading-4002729107"></span></h3></div><div class="panel-body" id="panel-4002729107"><p>Most of the paths and procedures presented here can be adapted to your system and your taste. You
can for instance decide to use different path names, or a different directory structure, it&apos;s up to
you, however we <strong>do not recommend you use different ways of installing the required
dependencies.</strong></p>
<p>In case you do not have particular needs, or you don&apos;t know what you are doing, please follow the
procedure <strong>very carefully and without diverging from it at all</strong>.</p>
<p>This will make support easier in case something does not work as expected.</p>
</div></div></p>
<h2 id="alibuild">aliBuild</h2>
<p>ALICE uses aliBuild to build software. aliBuild:</p>
<ul>
<li>knows how to build software via <a href="https://github.com/alisw/alidist" target="_blank">per-package recipes</a>,</li>
<li>manages the dependencies consistently,</li>
<li>rebuilds only what&apos;s necessary,</li>
<li>allows several versions of the same software to be installed at the same time.</li>
</ul>
<h2 id="your-operating-system">Your operating system</h2>
<p>There are different prerequisites depending on your operating system. The following list represents
what we support. If your operating system is in the list below, click on it to know what to do
<em>before</em> proceeding with the ALICE software installation.</p>
<p>If you are in doubt about what operating system to install on your new laptop, the list below might
be helpful.</p>
<p>If your operating system is <em>not</em> in the list below, it does not mean our software won&apos;t work on it;
it will be just more difficult for you to get support for it. We will be happy to add proper
documentation for additional operating systems!</p>
<ul>
<li><a href="prereq-macos.html">macOS High Sierra (10.13) and Mojave (10.14)</a></li>
<li><a href="prereq-ubuntu.html">Ubuntu 18.04 LTS, 17.10 and 16.04 LTS</a></li>
<li><a href="prereq-centos7.html">CentOS 7</a></li>
<li><a href="prereq-fedora.html">Fedora 27</a></li>
</ul>
<p>In case your operating system is not supported, you can <a href="#running-in-docker">run the whole build process under
Docker</a>.</p>
<h2 id="get-or-upgrade-alibuild">Get or upgrade aliBuild</h2>
<p>Install or upgrade <a href="https://pypi.python.org/pypi/alibuild/" target="_blank">aliBuild</a> with <code>pip</code>:</p>
<pre><code class="lang-bash">sudo pip install alibuild --upgrade
</code></pre>
<p>Now add the two following lines to your <code>~/.bashrc</code> or <code>~/.bash_profile</code> (depending on your
configuration):</p>
<pre><code class="lang-bash"><span class="hljs-built_in">export</span> ALIBUILD_WORK_DIR=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/alice/sw&quot;</span>
<span class="hljs-built_in">eval</span> <span class="hljs-string">&quot;`alienv shell-helper`&quot;</span>
</code></pre>
<p>The first line tells what directory is used as &quot;build cache&quot;, the second line installs a &quot;shell
helper&quot; that makes easier to run certain aliBuild-related commands.</p>
<p>You need to close and reopen your terminal for the change to be effective. The directory
<code>~/alice/sw</code> will be created the first time you run aliBuild.</p>
<blockquote>
<p>Note that this directory tends to grow in size over time, and it is the one you need to remove in
case of cleanups.</p>
</blockquote>
<h3 id="i-dont-have-root-permissions">I don&apos;t have root permissions</h3>
<p>In case you don&apos;t have root permissions, the most general way of installing aliBuild is to specify
a user directory where to install it. Start with opening your <code>~/.bashrc</code> or <code>~/.bash_profile</code> (this
depends on your system), and add the following lines:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">export</span> PYTHONUSERBASE=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/user_python&quot;</span>
<span class="hljs-built_in">export</span> PATH=<span class="hljs-string">&quot;<span class="hljs-variable">$PYTHONUSERBASE</span>/bin:<span class="hljs-variable">$PATH</span>&quot;</span>
</code></pre>
<p>Now close all your terminals and reopen them to load the new configuration. Check if it works by
printing the variable:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">echo</span> <span class="hljs-variable">$PYTHONUSERBASE</span>
</code></pre>
<p>The operations above need to be performed only once. Now, to install or upgrade aliBuild, just do:</p>
<pre><code class="lang-bash">pip install alibuild --upgrade --user
</code></pre>
<blockquote>
<p>This time we did not specify <code>sudo</code> and we have added the <code>--user</code> option. The Python variable
<code>PYTHONUSERBASE</code> tells <code>pip</code> where to install the package.</p>
</blockquote>
<p>Verify you have <code>aliBuild</code> in your path:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">type</span> aliBuild
</code></pre>
<h3 id="i-want-a-special-version-of-alibuild">I want a special version of aliBuild</h3>
<p>In some cases you might want to install a &quot;release candidate&quot; version, or you want to get the code
directly from GitHub. By default, the last stable version is installed. <strong>Do not install a special
version of aliBuild if you were not instructed to do so or if you don&apos;t know what you are doing, we
provide no support for unstable releases!</strong></p>
<p>To install a release candidate (for instance, <code>v1.5.1rc3</code>):</p>
<pre><code class="lang-bash">sudo pip install alibuild=v1.5.1rc3 --upgrade
</code></pre>
<p>To install from GitHub (you can specify a tag or a hash, or another branch, instead of <code>master</code>):</p>
<pre><code class="lang-bash">sudo pip install git+https://github.com/alisw/alibuild@master --upgrade
</code></pre>
<blockquote>
<p>Do not forget to drop <code>sudo</code> and add <code>--user</code> in case you do not have root permissions!</p>
</blockquote>
<h2 id="build-alice-software">Build ALICE software</h2>
<p>ALICE software is made of several dependencies, and aliBuild takes care of downloading them for you.
If you have exported the <code>$ALIBUILD_WORK_DIR</code> variable as described above, source code for all
dependencies will be &quot;hidden&quot; there. You want, however, to be able to see and control the source
code for the components you are developing: in our example we will show how to do that for AliRoot,
AliPhysics and (if you also develop Run 3 software) O2.</p>
<h3 id="initialize-or-update-your-work-area">Initialize or update your work area</h3>
<p>We will assume our work area is <code>~/alice</code>. Let&apos;s create it and download the source of the packages
we need to develop.</p>
<pre><code class="lang-bash">mkdir ~/alice
<span class="hljs-built_in">cd</span> ~/alice
</code></pre>
<p>For Run 2 software:</p>
<pre><code class="lang-bash">aliBuild init AliRoot,AliPhysics
</code></pre>
<p>For Run 3 software (you can have both Run 2 and Run 3 source code under the same directory):</p>
<pre><code class="lang-bash">aliBuild init O2 --defaults o2
</code></pre>
<blockquote>
<p>Do not forget the <code>--defaults o2</code>, aliBuild will complain if you don&apos;t specify it.</p>
</blockquote>
<p>The commands above will finish with a message like:</p>
<pre><code>==&gt; Development directory . created for aliroot, aliphysics
</code></pre><p>If you do <code>ls</code>, you will see the AliRoot, AliPhysics and O2 directories, plus an additional alidist
directory: this is the place containing the software recipes, telling aliBuild how to construct our
software, and you can ignore it.</p>
<p><div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(9230551284);" id="software-and-recipes-must-be-updated-manually"><i class="fa fa-info-circle"></i> Software and recipes must be updated manually!<span id="heading-9230551284"></span></h3></div><div class="panel-body" id="panel-9230551284"><p><code>aliBuild init</code> downloads software, and the recipes directory, for you the first time, but then they
will behave like any other Git directory and aliBuild will never update them any longer. You will
need to take care of the update yourself.</p>
<p>This means, in most cases, moving into the software directory and doing something like:</p>
<pre><code class="lang-bash">git checkout master
git reset --hard origin/master
git pull
</code></pre>
<p>Note that the operation above differs for O2 (where the default branch is <code>dev</code>, not <code>master</code>), and
the <code>git reset --hard</code> command is destructive: it will align your repository to the upstream one by
making you lose all your local changes.</p>
<p>If you want to checkout a specific version of the software, you have again to bear in mind that
AliRoot, AliPhysics and O2 are normal Git repositories. Do something like:</p>
<pre><code class="lang-bash">( <span class="hljs-built_in">cd</span> AliRoot &amp;&amp; git checkout v5-09-11 )
( <span class="hljs-built_in">cd</span> AliPhysics &amp;&amp; git checkout v5-09-11-01 )
</code></pre>
<p>instead of using <code>master</code> and pulling from there.</p>
</div></div></p>
<h3 id="check-your-prerequisites">Check your prerequisites</h3>
<p>aliBuild comes with the command <code>aliDoctor</code> that will help you identifying if your prerequisites
were installed correctly. In general, aliBuild is capable of building all required software
dependencies, but it has also the ability to take them &quot;from the system&quot; if possible, resulting in
less time spent for building for you.</p>
<p>Run the <code>aliDoctor</code> command to check dependencies for Run 2 software:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">cd</span> ~/alice
aliDoctor AliPhysics
</code></pre>
<p>For Run 2 software based on ROOT 6 (note: this is the only option on macOS):</p>
<pre><code class="lang-bash"><span class="hljs-built_in">cd</span> ~/alice
aliDoctor AliPhysics --defaults root6
</code></pre>
<p>For Run 3 software:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">cd</span> ~/alice
aliDoctor O2 --defaults o2
</code></pre>
<p>aliDoctor will warn you that some packages have to be built as they could not be found from the
system. If you have followed the instructions, this list should contain <strong>nothing more than</strong>:</p>
<ul>
<li>boost</li>
<li>CMake</li>
<li>GSL</li>
<li>nanomsg</li>
<li>protobuf</li>
<li>Vc</li>
<li>yaml-cpp</li>
<li>ZeroMQ</li>
<li>SWIG</li>
</ul>
<p>In particular, you should never have <code>Python</code> or <code>Python-modules</code>. If the output is longer than this
list, please go through the prerequisites once again and run <code>aliDoctor</code> again. If the output
contains those packages, or less packages, then you are fine and you may continue.</p>
<blockquote>
<p>If you think a package is shown but should not be in the list because you are sure you have
installed it, it might just be that its version it&apos;s incompatible (this frequently happens with
<code>CMake</code>) or you are missing the &quot;development&quot; package for that component.</p>
</blockquote>
<h3 id="build-and-rebuild">Build and rebuild</h3>
<p>If you have followed the prerequisites part thoroughly, and if you have double-checked it with
<code>aliDoctor</code>, it&apos;s time to run your build.</p>
<p>Remember that you have checked out <em>manually</em> the sources for AliRoot, AliPhysics and O2, so before
building make sure your sources are up to date by following the instructions above.</p>
<p>There are different ways of building Run 2 software depending on your configuration and your
desired features. The build command is:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">cd</span> ~/alice
aliBuild build AliPhysics [--defaults DEFAULTS]
</code></pre>
<p>Choose your <code>--defaults</code> accordingly:</p>
<table>
<thead>
<tr>
<th>Defaults</th>
<th>ROOT 6</th>
<th>GEANT3, 4, DPMJET</th>
<th>Works on macOS</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&lt;none&gt;</code></td>
<td>no</td>
<td>yes</td>
<td>no</td>
</tr>
<tr>
<td><code>user</code></td>
<td>no</td>
<td>no <em>(faster)</em></td>
<td>no</td>
</tr>
<tr>
<td><code>root6</code></td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr>
<td><code>user-root6</code></td>
<td>yes</td>
<td>no <em>(faster)</em></td>
<td>yes</td>
</tr>
</tbody>
</table>
<p>Note that <strong>it is mandatory to use ROOT 6 on macOS</strong>. ROOT 5 builds do not work there. In most cases
the <code>user</code> (and <code>user-root6</code>) installation is sufficient and takes less time and disk space.</p>
<p>You will need to run the <strong>exact same command</strong> when rebuilding, with the same <code>--defaults</code> option.</p>
<p><div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(7002985791);" id="build-with-root-5-and-6-at-the-same-time"><i class="fa fa-info-circle"></i> Build with ROOT 5 and 6 at the same time<span id="heading-7002985791"></span></h3></div><div class="panel-body" id="panel-7002985791"><p>If you want to build, using the same source, against ROOT 5 and ROOT 6 at the same time, you can do
that, it&apos;s explained <a href="#build-and-use-the-same-source-with-different-options">later on</a>.</p>
</div></div></p>
<p>The same command is used both for building the first time, and rebuilding: aliBuild is smart and
<strong>it will rebuild only what changed</strong>.</p>
<p><div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(4261281846);" id="why-is-alibuild-rebuilding-everything-&#x1F620;&#x1F92C;"><i class="fa fa-info-circle"></i> Why is aliBuild rebuilding everything?!?!? &#x1F620;&#x1F92C;<span id="heading-4261281846"></span></h3></div><div class="panel-body" id="panel-4261281846"><p>One or more of the following actions might change the way aliBuild sees and uses the dependencies
and might result in a <strong>full</strong> (or nearly full) rebuild. So, if an important conference is
approaching, <strong>plan the following actions accordingly as they might increase the build time</strong>:</p>
<ul>
<li>Updating recipes in <code>alidist</code></li>
<li>Removing the cache <code>$ALIBUILD_WORK_DIR</code> or forgetting to export the variable</li>
<li>Adding or removing system dependencies as seen by <code>aliDoctor</code></li>
<li>Updating your operating system or compilers (including Xcode on macOS)</li>
</ul>
</div></div></p>
<p>If you need to build Run 3 software, simply do:</p>
<pre><code class="lang-bash">aliBuild build O2 --defaults o2
</code></pre>
<p>on every platform.</p>
<p>aliBuild installation will finish with a clear indication of what to do to use the software you
have just built. This part is covered in the next section.</p>
<p><div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(811592109);" id="build-takes-up-too-many-laptop-resources"><i class="fa fa-info-circle"></i> Build takes up too many laptop resources!<span id="heading-811592109"></span></h3></div><div class="panel-body" id="panel-811592109"><p>Building ALICE software is a resource-expensive operation. By default, aliBuild uses as many laptop
resources as possible for building. If you need to work while building, you can use the <code>-j</code> flag to
tell aliBuild to use fewer CPUs (just one in the example below):</p>
<pre><code class="lang-bash">aliBuild build O2 -j 1 --defaults o2
</code></pre>
</div></div></p>
<h2 id="use-the-software-you-have-built">Use the software you have built</h2>
<p>aliBuild comes with a tool called <code>alienv</code>: this tool is used to load the correct environment for
the software you have built. Notably, <code>alienv</code> can manage multiple versions of the same software
without conflicts.</p>
<p>Just open a terminal and type:</p>
<pre><code class="lang-bash">alienv q
</code></pre>
<p>to display the list of available packages. To load the latest version you have built of AliPhysics,
do:</p>
<pre><code class="lang-bash">alienv enter AliPhysics/latest
</code></pre>
<blockquote>
<p>Note that this command will load AliPhysics <strong>and all its dependencies</strong> automatically, so there
is absolutely no need to also load, <em>e.g.</em>, AliRoot or ROOT!</p>
</blockquote>
<p>The <code>enter</code> command drops you to a new shell, meaning that you can &quot;clean up&quot; your environment by
simply exiting it.</p>
<blockquote>
<p>Please also note that aliBuild will tell you exactly what you need to type in order to load the
software you have just built. Just use aliBuild&apos;s suggestion in place of <code>AliPhysics/latest</code>
wherever appropriate.</p>
</blockquote>
<p>If you know what you are doing, you can also load the environment in your <em>current</em> shell:</p>
<pre><code class="lang-bash">alienv load AliPhysics/latest
</code></pre>
<p>In this case, you will clear the environment by doing:</p>
<pre><code class="lang-bash">alienv unload AliPhysics/latest
</code></pre>
<p>If you want to load the environment inside a script you are developing, just add this line:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">source</span> $(alienv printenv AliPhysics/latest)
</code></pre>
<p><div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(1839597094);" id="do-not-load-alienv-automatically"><i class="fa fa-info-circle"></i> Do not load alienv automatically!<span id="heading-1839597094"></span></h3></div><div class="panel-body" id="panel-1839597094"><p>Even if this is technically possible, it is strongly not recommended to load the environment with
<code>alienv</code> in your <code>~/.bashrc</code>! <strong>You must keep your environment pristine for safely running
aliBuild.</strong> By not loading the environment automatically, you will avoid a huge source of errors.</p>
<p>Do you still find annoying to type <code>alienv enter AliPhysics/latest</code> every time you want to use it?
You can add the following line in your <code>~/.bashrc</code> to make it more convenient:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">alias</span> ali=<span class="hljs-string">&apos;alienv enter AliPhysics/latest&apos;</span>
</code></pre>
<p>You are creating an alias called <code>ali</code>, that will load the environment by just typing it at the
prompt. Of course you can use any name you want.</p>
</div></div></p>
<h1 id="build-and-use-the-same-source-with-different-options">Build and use the same source with different options</h1>
<p>aliBuild and alienv give you the ability to build the same development source with different
defaults without duplicating the source, and without conflicts.</p>
<p>Imagine we are under <code>~/alice</code> and we have cloned AliRoot and AliPhysics with the <code>aliBuild init</code>
command above. We build AliPhysics <em>twice</em>, once with ROOT 5 and a second time against ROOT 6.</p>
<p><div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(5453071466);" id="root-package-in-development-mode"><i class="fa fa-info-circle"></i> ROOT package in development mode<span id="heading-5453071466"></span></h3></div><div class="panel-body" id="panel-5453071466"><p>Bear in mind that in this example we are assuming you don&apos;t have ROOT in development mode, <em>i.e.</em>
you have <em>only</em> cloned AliRoot and AliPhysics in your current directory (with <code>aliBuild init</code>), not
ROOT!</p>
<p>If you did that, then you need to manually enter the ROOT directory and checkout the proper ROOT
version by yourself.</p>
</div></div></p>
<p>Here&apos;s the ROOT 5 build command (note the <code>-z aliroot5</code> suffix, giving our build a special name
that allows to distinguish it from the ROOT 6 one):</p>
<pre><code class="lang-bash">aliBuild build AliPhysics --defaults user -z aliroot5
</code></pre>
<p>The command ends with a message saying what to do to use the package:</p>
<pre><code class="lang-bash">alienv enter AliPhysics/latest-aliroot5-user
</code></pre>
<p>Notice that aliBuild tells you <strong>what is the exact alienv command to run to use this build</strong>. Let&apos;s
do the same with ROOT 6 (note that we use a distinct name, <code>-z aliroot6</code>):</p>
<pre><code class="lang-bash">aliBuild build AliPhysics --defaults user-root6 -z aliroot6
</code></pre>
<p>Now, the message tells us to type:</p>
<pre><code class="lang-bash">alienv enter AliPhysics/latest-aliroot6-user-root6
</code></pre>
<p>to use the package. As you can see, <code>aliroot6</code> is part of the package name.</p>
<p>Keep in mind that:</p>
<ul>
<li>aliBuild always tells you what is the package name to load at the end of the build</li>
<li>you can load the two environments separately, in two different shells, with no chance of a mixup</li>
<li>you have used the same set of sources for generating two distinct builds</li>
<li><code>alienv enter AliPhysics/latest</code> will load the <em>latest you have built</em>, which can either be the
ROOT 5 or ROOT 6-based version: given its ambiguity, do use explicit names instead</li>
</ul>
<p>It is also possible to directly run <code>aliroot</code> (or any command you want) without &quot;entering&quot; the
environment:</p>
<pre><code class="lang-bash">alienv setenv AliPhysics/latest-aliroot5-user -c aliroot
alienv setenv AliPhysics/latest-aliroot6-user-root6 -c aliroot
</code></pre>
<p>The <code>aliroot</code> command will be run with the correct environment in both cases.</p>
<p><div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(8699154539);" id="migrating-from-root-5-to-root-6"><i class="fa fa-info-circle"></i> Migrating from ROOT 5 to ROOT 6<span id="heading-8699154539"></span></h3></div><div class="panel-body" id="panel-8699154539"><p>While you are at it, if you want to migrate your existing code to ROOT 6 (and make sure it works
there) check out our <a href="../analysis/ROOT5-to-6.html">migration guide</a>.</p>
</div></div></p>
<h2 id="build-specific-releases-tags-of-the-software">Build specific releases (tags) of the software</h2>
<p>It might come useful to build a certain tag of AliRoot and AliPhysics instead of simply pulling the
master.</p>
<blockquote>
<p>Note that <strong>we only guarantee that the current AliPhysics master works against the latest AliRoot
tag!</strong> It is therefore possible (though a rare occurrence) that the current AliRoot master breaks
the current AliPhysics master.</p>
</blockquote>
<p>If you have your source code in &quot;development mode&quot; (<em>i.e.</em> downloaded locally by means of <code>aliBuild
init</code>), since your AliRoot/AliPhysics/O2 directories <a href="#software-and-recipes-must-be-updated-manually">are mere Git
repositories</a>, you simply need to <code>cd</code> into them and
checkout the Git version you want.</p>
<p>For instance, if you want to build AliPhysics against AliRoot v5-09-33, you would need to first
move to the AliRoot directory and check the version out:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">cd</span> ~/alice/AliRoot
git fetch origin --tags
git checkout v5-09-33
</code></pre>
<p>Then update your AliPhysics master:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">cd</span> ~/alice/AliPhysics
git fetch origin master
git checkout master
git reset --hard origin/master
</code></pre>
<p>and then build normally using the <code>aliBuild</code> command. You might want to build using different <code>-z</code>
options <a href="#build-and-use-the-same-source-with-different-options">as explained here</a> in order to have
different builds usable in parallel without duplicating your source code.</p>
<h2 id="running-in-docker">Running in Docker</h2>
<p><a href="https://www.docker.com/" target="_blank">Docker</a> is a popular way to run Linux containers. As a consequence you
will get the runtime environment of a different operating system without the overhead of a virtual
machine.</p>
<p>This may be useful if your OS is unsupported, or if you want to have a fully isolated environment
for your ALICE builds: you simply create a container corresponding to one of the supported Linux
OSes and follow the corresponding prerequisites. <strong>The examples below focus on the CentOS 7
container as this is the reference environment for ALICE.</strong></p>
<p>This is how to install Docker on:</p>
<ul>
<li><a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/" target="_blank">Ubuntu</a></li>
<li><a href="https://docs.docker.com/install/linux/docker-ce/centos/" target="_blank">CentOS</a></li>
<li><a href="https://docs.docker.com/docker-for-mac/install/" target="_blank">macOS</a></li>
<li><a href="https://docs.docker.com/docker-for-windows/install/" target="_blank">Windows</a></li>
</ul>
<p>If you are a macOS user, you should tune your memory settings once for all by clicking on the Docker
whale icon in the taskbar, then <strong>Preferences... &#x2192; Advanced</strong>. Set the CPUs to the maximum
available, and the memory to at least 4 GB (the more the merrier). Click <strong>Apply &amp; Restart</strong>.</p>
<p>Create a persistent container by giving it a friendly name (we have chosen <code>aliceBuildEnvironment</code>):</p>
<pre><code class="lang-bash">docker run -it --name aliceBuildEnvironment -v <span class="hljs-variable">$HOME</span>/alice:<span class="hljs-variable">$HOME</span>/alice:rw centos:7
</code></pre>
<p>The <code>-v ...</code> switch tells Docker to make your system&apos;s directory <code>~/alice</code> visible under the exact
same path in your container. This allows Docker to save your work environment on your system, not
inside the container: your container is therefore <em>disposable</em>, even if you lose it you won&apos;t lose
your ALICE builds.</p>
<p><div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(5112765198);" id="use-the-same-directory-path"><i class="fa fa-info-circle"></i> Use the same directory path<span id="heading-5112765198"></span></h3></div><div class="panel-body" id="panel-5112765198"><p>It is quite important that you use the <strong>exact same directory name</strong> inside the container: this is
the only way to make aliBuild work on the same directory both inside the container and outside. This
allows you to share, for instance, the Git clones across installations on different platforms, and
save you gigabytes of space!</p>
<p>Please also note that the value of the variable <code>$HOME</code> inside the container will be different, so
before entering the container just display its value:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">echo</span> <span class="hljs-variable">$HOME</span>
</code></pre>
<p>and then inside the container <code>cd</code> into that path.</p>
</div></div></p>
<p>A root shell will open inside the container. It will be the same as using a CentOS 7 operating
system (in case you&apos;ve used the <a href="https://hub.docker.com/r/library/centos/" target="_blank">centos:7</a> container)
until you type <code>exit</code>: this means you will have to follow the <a href="#your-operating-system">proper installation
prerequisites</a> as usual.</p>
<p>When you are done with the prerequisites you can <a href="#get-or-upgrade-alibuild">continue your installation as
usual</a> inside the container.</p>
<h3 id="start-your-saved-container">Start your saved container</h3>
<p>Since your container is persistently saved, you can always restart it if you exit it or reboot your
computer with:</p>
<pre><code class="lang-bash">docker start aliceBuildEnvironment
</code></pre>
<p>The command will return immediately (and will do nothing if the container is already running). Once
started (check with <code>docker ps</code>) you can connect to it as many times as you want with:</p>
<pre><code class="lang-bash">docker <span class="hljs-built_in">exec</span> -it aliceBuildEnvironment bash
</code></pre>
<h3 id="remove-your-container">Remove your container</h3>
<p>In case your container environment gets messed up for some reason, you can erase it completely with:</p>
<pre><code class="lang-bash">docker rm <span class="hljs-_">-f</span> aliceBuildEnvironment
</code></pre>
<p>This will terminate any active session if running. Since your <code>~/alice</code> directory contains all the
aliBuild installation artifacts, if you intend to perform an aliBuild cleanup you should remove that
directory too.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../analysis/ROOT5-to-6.html" class="navigation navigation-prev " aria-label="Previous page: Transition from ROOT5 to ROOT6">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="prereq-macos.html" class="navigation navigation-next " aria-label="Next page: aliBuild prerequisites for macOS">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Building ALICE software","level":"1.3","depth":1,"next":{"title":"aliBuild prerequisites for macOS","level":"1.3.1","depth":2,"path":"building/prereq-macos.md","ref":"building/prereq-macos.md","articles":[]},"previous":{"title":"Transition from ROOT5 to ROOT6","level":"1.2.9","depth":2,"path":"analysis/ROOT5-to-6.md","ref":"analysis/ROOT5-to-6.md","articles":[]},"dir":"ltr"},"config":{"plugins":["katex","panels@git+https://github.com/lhcb/gitbook-plugin-panels.git#117012fdc18c96831cb88196980c0ea73b0c87b8","collapsible-menu","block-align","page-toc"],"styles":{"website":"css/website.css"},"pluginsConfig":{"collapsible-menu":{},"block-align":{},"search":{},"page-toc":{"position":"before-first","selector":".markdown-section h1, .markdown-section h2, .markdown-section h3, .markdown-section h4","showByDefault":true},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"panels":{},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"ALICE Analysis Tutorial","gitbook":"*","description":"Introduction to the common analysis techniques and tools of ALICE"},"file":{"path":"building/README.md","mtime":"2018-10-16T16:11:21.366Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-10-16T16:12:34.539Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-panels/panels.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-page-toc/anchor-3.1.1.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-page-toc/page-toc.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

